# ğŸš¨ ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - è¨­å®šã‚¬ã‚¤ãƒ‰

**ä½œæˆæ—¥**: 2025å¹´10æœˆ1æ—¥  
**ç›®çš„**: Kibanaãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«æ¤œçŸ¥ãƒ»å¯è¦–åŒ–

## ğŸ“Š ç”Ÿæˆã•ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡

ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®8ç¨®é¡ã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ï¼š

| ã‚¨ãƒ©ãƒ¼ç¨®é¡ | ãƒ—ãƒ­ã‚°ãƒ©ãƒ  | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹ |
|-----------|-----------|-------------|
| **èªè¨¼ã‚¨ãƒ©ãƒ¼** | sshd | `error: PAM: authentication error for illegal user admin` |
| **ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•å¤±æ•—** | systemd | `Failed to start Application Service - error code XXX` |
| **CPUéç†±** | kernel | `ERROR: CPU throttling detected - temperature critical` |
| **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¤±æ•—** | cron | `ERROR: backup script failed with exit code 1` |
| **Webã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼** | nginx | `GET /api/users HTTP/1.1 500 Internal Server Error` |
| **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼** | mysql | `ERROR 1045: Access denied for user 'root'@'localhost'` |
| **Dockerã‚¨ãƒ©ãƒ¼** | docker | `Error response from daemon: container not found` |
| **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼** | application | `Exception in thread main: NullPointerException` |

ã™ã¹ã¦ã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã«ã¯ `level: "error"` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒä»˜ä¸ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ¯ ã‚¹ãƒ†ãƒƒãƒ—1: Data Viewã®ç¢ºèª

### 1.1 Data Viewã«ã‚¢ã‚¯ã‚»ã‚¹

```
http://localhost:5601/app/management/kibana/dataViews
```

### 1.2 æ—¢å­˜ã®Data Viewã‚’ç¢ºèª

- `logstash-*` ã®Data ViewãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
- ãªã‘ã‚Œã°ä½œæˆï¼š
  - Index pattern: `logstash-*`
  - Timestamp field: `@timestamp`

## ğŸ“ˆ ã‚¹ãƒ†ãƒƒãƒ—2: ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ä½œæˆ

### 2.1 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’æ–°è¦ä½œæˆ

1. **Kibanaãƒ¡ãƒ‹ãƒ¥ãƒ¼**ã‚’é–‹ãï¼ˆå·¦ä¸Šã® â˜° ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
2. **Analytics** â†’ **Dashboard** ã‚’é¸æŠ
3. **Create dashboard** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

### 2.2 å¯è¦–åŒ–ãƒ‘ãƒãƒ«ã‚’è¿½åŠ 

ä»¥ä¸‹ã®é †ç•ªã§ãƒ‘ãƒãƒ«ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚

---

#### ğŸ“Š ãƒ‘ãƒãƒ«1: ã‚¨ãƒ©ãƒ¼ä»¶æ•°ã®æ™‚ç³»åˆ—ã‚°ãƒ©ãƒ•

**ç›®çš„**: ã‚¨ãƒ©ãƒ¼ã®ç™ºç”Ÿå‚¾å‘ã‚’æ™‚ç³»åˆ—ã§æŠŠæ¡

1. **Create visualization** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. å¯è¦–åŒ–ã‚¿ã‚¤ãƒ—: **Line** (æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•)
3. è¨­å®š:
   ```
   Vertical axis (Yè»¸):
     - Aggregation: Count
     - Display name: ã‚¨ãƒ©ãƒ¼ä»¶æ•°
   
   Horizontal axis (Xè»¸):
     - Field: @timestamp
     - Minimum interval: Auto
   
   Breakdown (åˆ†é¡):
     - Field: level.keyword
   
   Filters:
     - level: "error"
   ```
4. **Save and return** ã‚’ã‚¯ãƒªãƒƒã‚¯

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**: æ™‚é–“ã”ã¨ã®ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿä»¶æ•°ã‚’ç¤ºã™æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•

---

#### ğŸ“Š ãƒ‘ãƒãƒ«2: ã‚¨ãƒ©ãƒ¼ç¨®é¡åˆ¥ã®å††ã‚°ãƒ©ãƒ•

**ç›®çš„**: ã©ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚¨ãƒ©ãƒ¼ãŒå¤šã„ã‹æŠŠæ¡

1. **Create visualization** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. å¯è¦–åŒ–ã‚¿ã‚¤ãƒ—: **Donut** (ãƒ‰ãƒ¼ãƒŠãƒ„ã‚°ãƒ©ãƒ•)
3. è¨­å®š:
   ```
   Slice by:
     - Field: syslog_program.keyword
     - Number of values: 10
   
   Size by:
     - Aggregation: Count
   
   Filters:
     - level: "error"
   ```
4. ã‚¿ã‚¤ãƒˆãƒ«: `ã‚¨ãƒ©ãƒ¼ç¨®é¡åˆ¥åˆ†å¸ƒ`
5. **Save and return** ã‚’ã‚¯ãƒªãƒƒã‚¯

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**: ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã”ã¨ã®ã‚¨ãƒ©ãƒ¼å‰²åˆã‚’ç¤ºã™å††ã‚°ãƒ©ãƒ•

---

#### ğŸ“Š ãƒ‘ãƒãƒ«3: æœ€æ–°ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ãƒ†ãƒ¼ãƒ–ãƒ«

**ç›®çš„**: ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèª

1. **Create visualization** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. å¯è¦–åŒ–ã‚¿ã‚¤ãƒ—: **Table** (ãƒ†ãƒ¼ãƒ–ãƒ«)
3. è¨­å®š:
   ```
   Rows:
     1. @timestamp (æœ€æ–°é †)
     2. syslog_program.keyword
     3. syslog_message.keyword
   
   Metrics:
     - ãªã—ï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¡¨ç¤ºã®ã¿ï¼‰
   
   Filters:
     - level: "error"
   
   Sort:
     - @timestamp descending
   
   Size: 10
   ```
4. ã‚¿ã‚¤ãƒˆãƒ«: `æœ€æ–°ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°`
5. **Save and return** ã‚’ã‚¯ãƒªãƒƒã‚¯

---

#### ğŸ“Š ãƒ‘ãƒãƒ«4: ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«åˆ¥ã®ãƒ¡ãƒˆãƒªãƒƒã‚¯

**ç›®çš„**: ã‚¨ãƒ©ãƒ¼ã€è­¦å‘Šã€æƒ…å ±ãƒ­ã‚°ã®æ¯”ç‡ã‚’æŠŠæ¡

1. **Create visualization** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. å¯è¦–åŒ–ã‚¿ã‚¤ãƒ—: **Metric** (æ•°å€¤è¡¨ç¤º)
3. è¨­å®š:
   ```
   Primary metric:
     - Aggregation: Count
     - Display name: ç·ã‚¨ãƒ©ãƒ¼æ•°
   
   Filters:
     - level: "error"
   ```
4. ã‚¿ã‚¤ãƒˆãƒ«: `ç·ã‚¨ãƒ©ãƒ¼æ•°`
5. ã‚«ãƒ©ãƒ¼è¨­å®š: èµ¤è‰²
6. **Save and return** ã‚’ã‚¯ãƒªãƒƒã‚¯

---

#### ğŸ“Š ãƒ‘ãƒãƒ«5: ã‚¨ãƒ©ãƒ¼é »åº¦ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—

**ç›®çš„**: æ™‚é–“å¸¯åˆ¥ã®ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠŠæ¡

1. **Create visualization** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. å¯è¦–åŒ–ã‚¿ã‚¤ãƒ—: **Heat map** (ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—)
3. è¨­å®š:
   ```
   Vertical axis:
     - Field: syslog_program.keyword
   
   Horizontal axis:
     - Field: @timestamp
     - Interval: 1h
   
   Cell intensity:
     - Aggregation: Count
   
   Filters:
     - level: "error"
   ```
4. ã‚¿ã‚¤ãƒˆãƒ«: `æ™‚é–“å¸¯åˆ¥ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿãƒ‘ã‚¿ãƒ¼ãƒ³`
5. **Save and return** ã‚’ã‚¯ãƒªãƒƒã‚¯

---

### 2.3 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ä¿å­˜

1. å³ä¸Šã® **Save** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã‚¿ã‚¤ãƒˆãƒ«: `ã‚¨ãƒ©ãƒ¼ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰`
3. èª¬æ˜: `ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç›£è¦–`
4. **Save** ã‚’ã‚¯ãƒªãƒƒã‚¯

## ğŸ” ã‚¹ãƒ†ãƒƒãƒ—3: Discoverã§ã‚¨ãƒ©ãƒ¼ã‚’æ¤œç´¢

### 3.1 ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿è¡¨ç¤º

**URL**: http://localhost:5601/app/discover

**æ¤œç´¢ã‚¯ã‚¨ãƒª**:
```
level: "error"
```

### 3.2 ç‰¹å®šãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚¨ãƒ©ãƒ¼

```
level: "error" AND syslog_program: "mysql"
```

### 3.3 ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§æ¤œç´¢

```
level: "error" AND syslog_message: *failed*
```

### 3.4 æ™‚é–“ç¯„å›²æŒ‡å®š

- å³ä¸Šã®æ™‚é–“ç¯„å›²ã‚’ã€ŒLast 24 hoursã€ã«è¨­å®š
- ã‚«ã‚¹ã‚¿ãƒ ç¯„å›²ã‚‚æŒ‡å®šå¯èƒ½

## ğŸš¨ ã‚¹ãƒ†ãƒƒãƒ—4: ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

Kibana 8.x ã§ã¯ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆAlertingï¼‰ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚

### 4.1 ã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆ

1. **â˜° ãƒ¡ãƒ‹ãƒ¥ãƒ¼** â†’ **Stack Management** â†’ **Rules and Connectors**
2. **Create rule** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ«ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ—: **Elasticsearch query**

### 4.2 ã‚¢ãƒ©ãƒ¼ãƒˆæ¡ä»¶ã®è¨­å®š

```yaml
Name: ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ã‚¢ãƒ©ãƒ¼ãƒˆ
Rule type: Elasticsearch query

Index: logstash-*

Query:
  {
    "query": {
      "bool": {
        "must": [
          { "term": { "level": "error" } },
          { "range": { "@timestamp": { "gte": "now-5m" } } }
        ]
      }
    }
  }

Threshold: count > 3 (5åˆ†é–“ã«3ä»¶ä»¥ä¸Šã®ã‚¨ãƒ©ãƒ¼)

Actions:
  - Webhook (Slack, Email, etc.)
  - Index (åˆ¥ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ä¿å­˜)
```

### 4.3 é€šçŸ¥å…ˆã®è¨­å®š

**Slackã¸ã®é€šçŸ¥ä¾‹**:
```json
{
  "text": "âš ï¸ ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥: {{context.hits}} ä»¶ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"
}
```

**Emailã¸ã®é€šçŸ¥ä¾‹**:
```
ä»¶å: [ã‚¢ãƒ©ãƒ¼ãƒˆ] ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥
æœ¬æ–‡: éå»5åˆ†é–“ã« {{context.hits}} ä»¶ã®ã‚¨ãƒ©ãƒ¼ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚
```

## ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—5: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### 5.1 æ™‚é–“ç¯„å›²ã®è¨­å®š

- å³ä¸Šã®æ™‚é–“ç¯„å›²ã‚’ **Last 24 hours** ã¾ãŸã¯ **Last 7 days** ã«è¨­å®š
- **Auto-refresh** ã‚’æœ‰åŠ¹åŒ–ï¼ˆä¾‹: 30ç§’ã”ã¨ï¼‰

### 5.2 ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®è¿½åŠ 

**ãƒ—ãƒ­ã‚°ãƒ©ãƒ åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**:
```
syslog_program: "mysql" OR syslog_program: "nginx"
```

**é‡è¦åº¦åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**:
```
level: "error" OR level: "warning"
```

### 5.3 ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰è¨­å®š

- **Error**: èµ¤è‰² (#FF0000)
- **Warning**: ã‚ªãƒ¬ãƒ³ã‚¸è‰² (#FFA500)
- **Info**: ç·‘è‰² (#00FF00)

## ğŸ¨ å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã¯ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚¨ãƒ©ãƒ¼ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ç·ã‚¨ãƒ©ãƒ¼æ•°  â”‚  â”‚   ã‚¨ãƒ©ãƒ¼ä»¶æ•°ã®æ™‚ç³»åˆ—ã‚°ãƒ©ãƒ•      â”‚ â”‚
â”‚  â”‚     15      â”‚  â”‚         ğŸ“ˆ                      â”‚ â”‚
â”‚  â”‚     ä»¶      â”‚  â”‚                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ã‚¨ãƒ©ãƒ¼ç¨®é¡åˆ†å¸ƒâ”‚  â”‚  æ™‚é–“å¸¯åˆ¥ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³         â”‚ â”‚
â”‚  â”‚     ğŸ©       â”‚  â”‚         ğŸ”¥                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœ€æ–°ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Time         | Program | Message                 â”‚ â”‚
â”‚  â”‚ 10:30:45     | mysql   | ERROR 1045: Access...  â”‚ â”‚
â”‚  â”‚ 10:25:30     | kernel  | ERROR: CPU throttl...  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ å®Ÿç”¨çš„ãªã‚¯ã‚¨ãƒªé›†

### ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿è¡¨ç¤º
```
level: "error"
```

### éå»1æ™‚é–“ã®ã‚¨ãƒ©ãƒ¼
```
level: "error" AND @timestamp >= now-1h
```

### ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ¤œç´¢
```
syslog_message: *"ERROR"* OR syslog_message: *"failed"* OR syslog_message: *"exception"*
```

### CronJobã§ç”Ÿæˆã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ã®ã¿
```
level: "error" AND source: "cronjob-generator"
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£ã®ã‚¨ãƒ©ãƒ¼
```
level: "error" AND (syslog_program: "mysql" OR syslog_program: "postgres")
```

## ğŸ“ˆ ã‚¨ãƒ©ãƒ¼çµ±è¨ˆã®ç¢ºèª

### Elasticsearchã§ã‚¨ãƒ©ãƒ¼ä»¶æ•°ã‚’ç¢ºèª

```bash
# ç·ã‚¨ãƒ©ãƒ¼æ•°
kubectl exec -n elk-stack deployment/elasticsearch -- \
  curl -s "http://localhost:9200/logstash-*/_count" \
  -H "Content-Type: application/json" \
  -d '{"query":{"term":{"level":"error"}}}'

# ãƒ—ãƒ­ã‚°ãƒ©ãƒ åˆ¥ã‚¨ãƒ©ãƒ¼é›†è¨ˆ
kubectl exec -n elk-stack deployment/elasticsearch -- \
  curl -s "http://localhost:9200/logstash-*/_search?pretty" \
  -H "Content-Type: application/json" \
  -d '{
    "size": 0,
    "query": {"term": {"level": "error"}},
    "aggs": {
      "by_program": {
        "terms": {"field": "syslog_program.keyword", "size": 10}
      }
    }
  }'
```

## ğŸ¯ é‹ç”¨ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. å®šæœŸçš„ãªç¢ºèª

- **æ¯æ—¥**: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ç·ã‚¨ãƒ©ãƒ¼æ•°ã‚’ç¢ºèª
- **æ¯é€±**: ã‚¨ãƒ©ãƒ¼å‚¾å‘ã‚’åˆ†æã—ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠŠæ¡
- **æ¯æœˆ**: æœ€ã‚‚é »ç™ºã™ã‚‹ã‚¨ãƒ©ãƒ¼ã®åŸå› èª¿æŸ»ã¨å¯¾ç­–

### 2. ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

- **Critical**: 5åˆ†é–“ã«5ä»¶ä»¥ä¸Šã®ã‚¨ãƒ©ãƒ¼ â†’ å³åº§ã«é€šçŸ¥
- **High**: 1æ™‚é–“ã«10ä»¶ä»¥ä¸Šã®ã‚¨ãƒ©ãƒ¼ â†’ 1æ™‚é–“ä»¥å†…ã«ç¢ºèª
- **Medium**: 1æ—¥ã«50ä»¶ä»¥ä¸Šã®ã‚¨ãƒ©ãƒ¼ â†’ ç¿Œæ—¥ã¾ã§ã«ç¢ºèª

### 3. ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```
ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥
    â†“
ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ç¢ºèª
    â†“
é‡å¤§åº¦è©•ä¾¡ï¼ˆCritical/High/Medium/Lowï¼‰
    â†“
å¯¾å¿œï¼š
  - Critical: å³åº§ã«å¯¾å¿œ
  - High: 1æ™‚é–“ä»¥å†…
  - Medium: 1æ—¥ä»¥å†…
  - Low: é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼
```

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [PERIODIC_LOG_COLLECTION.md](PERIODIC_LOG_COLLECTION.md) - ãƒ­ã‚°åé›†ã‚·ã‚¹ãƒ†ãƒ 
- [LOG_COLLECTION_SUCCESS.md](LOG_COLLECTION_SUCCESS.md) - ãƒ­ã‚°åé›†æˆåŠŸãƒ¬ãƒãƒ¼ãƒˆ
- [README.md](README.md) - ELKã‚¹ã‚¿ãƒƒã‚¯å…¨ä½“ã®èª¬æ˜

## ğŸ”— ä¾¿åˆ©ãªãƒªãƒ³ã‚¯

**Kibana URLé›†**:
- Dashboard: http://localhost:5601/app/dashboards
- Discover: http://localhost:5601/app/discover
- Visualize: http://localhost:5601/app/visualize
- Alerts: http://localhost:5601/app/management/insightsAndAlerting/triggersActions/rules

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ1æ—¥  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… è¨­å®šå®Œäº†  
**ã‚¨ãƒ©ãƒ¼ç”Ÿæˆ**: è‡ªå‹•ï¼ˆ5åˆ†ã”ã¨ã«ç´„40%ã®ç¢ºç‡ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ï¼‰



